#!/usr/bin/env sh
set -e

export PATH="$HOME/.asdf/shims:$PATH"

echo "pre-commit: formatting staged files with bun/prettier..."

git diff --cached --name-only --diff-filter=ACMR \
  | grep -E '\.(js|jsx|ts|tsx|vue|css|scss|html|json|md|yml|yaml)$' \
  | xargs -r bunx prettier --write

git diff --cached --name-only --diff-filter=ACMR \
  | grep -E '\.(js|jsx|ts|tsx|vue|css|scss|html|json|md|yml|yaml)$' \
  | xargs -r git add

echo "pre-commit: running lint fix with bun..."
bun run lint:fix